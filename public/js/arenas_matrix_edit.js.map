{"version":3,"names":[],"mappings":"","sources":["arenas_matrix_edit.js"],"sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n(function (global){\n'use strict';\n\nvar $ = (typeof window !== \"undefined\" ? window['jQuery'] : typeof global !== \"undefined\" ? global['jQuery'] : null);\n\n$('.success-panel, .error-panel').addClass('alert fade in');\n$().alert();\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],2:[function(require,module,exports){\n(function (global){\n'use strict';\n\nrequire('./app.js');\n\nvar _jquery = (typeof window !== \"undefined\" ? window['jQuery'] : typeof global !== \"undefined\" ? global['jQuery'] : null);\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// DOM Elements\nvar $form = void 0,\n    // Main form\n$nameInput = void 0,\n    $plusButton = void 0,\n    $minusButton = void 0; // Table title input\n\n// Module globals\n// editing mode (true -> editing, false -> creating a new sample_group)\nvar currentRow = 1;\n\nfunction init() {\n    cacheDom();\n    var edit_mode = $form.data('edit');;\n    setupForm(edit_mode);\n    bindHandlers();\n}\n\nfunction cacheDom() {\n    $form = (0, _jquery2.default)('#the_form');\n    $nameInput = $form.find('input[name=\"name\"]');\n    $plusButton = (0, _jquery2.default)('.plus-button');\n    $minusButton = (0, _jquery2.default)('.minus-button');\n}\n\nfunction setupForm(edit_mode) {\n    if (edit_mode) {\n        getPreviousData().then(writeInForm, handleError);\n    } else {\n        for (var i = 0; i < 10; ++i) {\n            addRow();\n        }\n    }\n}\n\nfunction getPreviousData() {\n    var id = $form.data('sampleGroupId');\n    return _jquery2.default.getJSON('/api/arenas/sample_group/' + id);\n}\n\nfunction writeInForm(sample_group) {\n    $nameInput.val(sample_group.name);\n    // Hide empty row (comes with the html)\n    hideRow();\n    sample_group.samples.forEach(addRow);\n}\n\nfunction addRow(sample) {\n    var grain_size = void 0,\n        frequency = void 0;\n    if (sample === undefined) {\n        grain_size = frequency = '';\n    } else {\n        grain_size = sample.grain_size;\n        frequency = sample.frequency;\n    }\n    // Create new DOM Elements\n    var $tr = (0, _jquery2.default)('<tr>');\n    var $td_left = (0, _jquery2.default)('<td>');\n    var $td_right = (0, _jquery2.default)('<td>');\n    // Create by cloning existent\n    var $input_size = (0, _jquery2.default)('[name=\"grain-size-' + currentRow + '\"]').clone();\n    var $input_frequency = (0, _jquery2.default)('[name=\"frequency-' + currentRow + '\"]').clone();\n\n    ++currentRow;\n    $input_size.attr('name', 'grain-size-' + currentRow).val(grain_size);\n    $input_frequency.attr('name', 'frequency-' + currentRow).val(frequency);\n\n    $td_left.append($input_size);\n    $td_right.append($input_frequency);\n    $tr.append($td_left, $td_right);\n\n    // Append the newly created row before the button row\n    var $last_tr = (0, _jquery2.default)('#the_form .button-row');\n    $last_tr.before($tr);\n}\n\nfunction hideRow() {\n    var $last_row = getLastRow();\n    // Empty row before hiding\n    $last_row.find('input').val('');\n\n    $last_row.hide();\n}\n\nfunction getLastRow() {\n    // Get button row...\n    var $last_row = (0, _jquery2.default)('#the_form .button-row');\n\n    // And go back until there is a column which is not hidden\n    do {\n        $last_row = $last_row.prev();\n    } while ($last_row.is(':hidden') && $last_row.is('tr'));\n\n    return $last_row;\n}\n\nfunction bindHandlers() {\n    $plusButton.click(addRow);\n    $minusButton.click(hideRow);\n}\n\nfunction handleError() {\n    // TODO: handle error properly\n    alert('Error obteniendo los valores previos de la muestra');\n}\n\ninit();\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"./app.js\":1}]},{},[2]);\n"],"file":"arenas_matrix_edit.js","sourceRoot":"/source/"}